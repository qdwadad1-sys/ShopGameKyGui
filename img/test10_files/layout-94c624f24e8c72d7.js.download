(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7523],{19457:function(e,t,n){Promise.resolve().then(n.bind(n,92068)),Promise.resolve().then(n.bind(n,53603))},45885:function(e,t,n){"use strict";n.d(t,{Gs:function(){return l},Ni:function(){return s},Ox:function(){return c},a3:function(){return a}});var o=n(74101),i=n(79122),r=n(42787);let c=async(e,t)=>{let n=(0,i.B5)(new URL("".concat(o.publicRuntimeConfig.apiUrl,"user/favorites")),e),c=await (0,r.BB)({url:n,options:{method:"GET",credentials:"same-origin",headers:{authorization:"Token ".concat(t),"Content-Type":"application/json"}}});return await c.json()},a=async(e,t,n,o)=>u(e,t,n,"POST",o),s=async(e,t,n,o)=>u(e,t,n,"DELETE",o),u=async(e,t,n,o,i)=>{let c=await (0,r.BB)({url:f("user/favorites",t,i),options:{method:o,body:"gif_id=".concat(e),headers:{cookie:n,Accept:"application/json",Authorization:"Token ".concat(t),"Content-Type":"application/x-www-form-urlencoded; charset=utf-8"}}});return await c.json()},l=async(e,t,n)=>{let o=await (0,r.BB)({url:f("user/favorites/statuses",t,n),options:{method:"POST",headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({gif_ids:[e]})}});return(await o.json()).data.length>0};function f(e,t,n){let r;let c="".concat(o.publicRuntimeConfig.apiUrl).concat(e);try{r=new URL(c)}catch(e){throw console.error("Invalid URL:",c),e}return(0,i.B5)(r,{api_key:n,access_token:t})}},14789:function(e,t,n){"use strict";n.d(t,{c5:function(){return l},k1:function(){return w},xL:function(){return d}});var o=n(27573),i=n(45885),r=n(79122),c=n(7653),a=n(6928);let s=(0,c.createContext)({favorites:[],setFavorites:()=>{},hasChecked:[],setHasChecked:()=>{}}),u=e=>{let{user:t}=(0,c.useContext)(a.Z),n=(0,c.useState)([]),[o,i]=(0,c.useState)(!1),s=(0,c.useRef)(!1),[u,l]=n,d=(0,r.vl)();return(0,c.useEffect)(()=>{if(t){if(!s.current){s.current=!0;let n=window.localStorage.getItem(e);f(n?JSON.parse(n):[],t,e,d)}}else if(o)try{window.localStorage.setItem(e,JSON.stringify(Array.from(new Set(u))))}catch(t){console.error("failed to set ".concat(e," in local"))}else try{let t=window.localStorage.getItem(e);l(t?JSON.parse(t):[]),i(!0)}catch(e){}},[d,o,e,l,u,t]),n},l=e=>{let{children:t}=e,[n,i]=u("local-favorites"),[r,a]=(0,c.useState)([]);return(0,c.useEffect)(()=>{},[]),(0,o.jsx)(s.Provider,{value:{favorites:n,setFavorites:i,hasChecked:r,setHasChecked:a},children:t})};async function f(e,t,n,o){let r=e[0];if(r)try{setTimeout(async()=>{await (0,i.a3)(r,t.token,document.cookie,o),window.localStorage.setItem(n,JSON.stringify(e.filter(e=>e!==r))),f(e.slice(1),t,n,o)},100)}catch(e){console.error("failed to sync favorite ".concat(r),e)}}function d(e){let{user:t}=(0,c.useContext)(a.Z),n=(0,r.vl)(),{favorites:o,setFavorites:u,hasChecked:l,setHasChecked:f}=(0,c.useContext)(s),d=(0,c.useRef)(!1);if((0,c.useEffect)(()=>{async function o(e){if(t){let o=await (0,i.Gs)(e,t.token,n);u(t=>{let n=t.includes(e);return o&&!n?[...t,e]:!o&&n?t.filter(t=>t!==e):t}),f(t=>[...t,e])}}!e||d.current||l.includes(e)||(d.current=!0,o(e))},[n,l,e,u,f,t]),e)return t?l.includes(e)?o.includes(e):void 0:o.includes(e)}function w(){let{user:e}=(0,c.useContext)(a.Z),t=(0,r.vl)(),{favorites:n,setFavorites:o}=(0,c.useContext)(s);return async function(r){let c=n.includes(r);if(e)return c?c&&(await (0,i.Ni)(r,e.token,document.cookie,t),o(e=>e.filter(e=>e!==r))):(await (0,i.a3)(r,e.token,document.cookie,t),o(e=>[...e,r])),!c;c?o(e=>e.filter(e=>e!==r)):o(e=>[...e,r])}}t.ZP=s}},function(e){e.O(0,[1307,3108,6623,8394,1895,1661,772,664,8146,7522,298,3920,455,4249,3610,6566,4294,456,6873,7189,401,4552,2544,2068,1293,1528,1744],function(){return e(e.s=19457)}),_N_E=e.O()}]);
//# sourceMappingURL=layout-94c624f24e8c72d7.js.map